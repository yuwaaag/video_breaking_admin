<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel ‚Äî Breaking News</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',sans-serif;background:#07071a;color:#fff;min-height:100vh}

.topbar{background:#0d0d25;border-bottom:2px solid #e63946;padding:14px 28px;display:flex;align-items:center;gap:14px}
.topbar .logo{background:#e63946;color:#fff;font-weight:900;font-size:11px;padding:5px 12px;border-radius:4px;letter-spacing:2px}
.topbar h1{font-size:18px;font-weight:700;flex:1}
.topbar a{color:#4caf50;font-size:13px;text-decoration:none;font-weight:700;margin-left:12px}
.topbar a:hover{text-decoration:underline}
.dot{width:9px;height:9px;border-radius:50%;background:#4caf50;animation:blink 1.5s infinite;margin-right:4px}
@keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

/* TABS */
.tabs{background:#0a0a20;border-bottom:1px solid #1a1a3a;display:flex;padding:0 28px}
.tab{padding:14px 24px;font-size:13px;font-weight:700;color:#555;cursor:pointer;border-bottom:3px solid transparent;transition:all .2s;letter-spacing:.5px}
.tab:hover{color:#aaa}
.tab.active{color:#fff;border-bottom-color:#e63946}

/* PANELS */
.panel{display:none;padding:28px}
.panel.active{display:block}

/* CONFIG PANEL */
.config-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;max-width:800px}
.config-card{background:#111128;border:1px solid #1e1e4a;border-radius:12px;padding:24px}
.config-card h3{font-size:14px;font-weight:700;color:#e63946;margin-bottom:18px;letter-spacing:1px;text-transform:uppercase;display:flex;align-items:center;gap:8px}
.field{margin-bottom:16px}
.field label{display:block;font-size:11px;font-weight:700;color:#666;letter-spacing:1px;text-transform:uppercase;margin-bottom:6px}
.field input{width:100%;background:#0d0d25;border:1px solid #2a2a5a;color:#fff;padding:10px 14px;border-radius:8px;font-size:13px;transition:border-color .2s}
.field input:focus{outline:none;border-color:#e63946}
.field input.ok{border-color:#4caf50}
.field .hint{font-size:11px;color:#444;margin-top:5px}
.field .hint a{color:#666;text-decoration:none}
.field .hint a:hover{color:#e63946}
.save-btn{width:100%;background:linear-gradient(135deg,#e63946,#c62828);color:#fff;border:none;padding:13px;border-radius:9px;font-size:14px;font-weight:700;cursor:pointer;letter-spacing:1px;text-transform:uppercase;transition:all .2s;margin-top:4px}
.save-btn:hover{box-shadow:0 6px 20px rgba(230,57,70,.4)}
.test-btn{width:100%;background:#1a1a3a;color:#aaa;border:1px solid #2a2a5a;padding:10px;border-radius:8px;font-size:13px;font-weight:600;cursor:pointer;transition:all .2s}
.test-btn:hover{background:#2a2a5a;color:#fff}
.status-box{background:#0d0d25;border:1px solid #1a1a3a;border-radius:8px;padding:14px;margin-top:14px;font-size:12px;color:#666;min-height:48px;line-height:1.6}
.status-box.success{border-color:#1a3a1a;color:#4caf50}
.status-box.error{border-color:#3a1a1a;color:#e63946}
.config-full{grid-column:1/-1}
.how-to{background:#0d0d20;border:1px solid #1a1a3a;border-radius:10px;padding:18px 20px;margin-top:16px}
.how-to h4{font-size:12px;font-weight:700;color:#888;margin-bottom:10px;letter-spacing:1px}
.how-to ol{padding-left:18px;color:#555;font-size:12px;line-height:2}
.how-to ol li span{color:#e63946;font-weight:700}

/* NEWS PANEL */
.news-layout{display:grid;grid-template-columns:1fr 1fr;gap:24px}
.section-title{font-size:12px;font-weight:700;letter-spacing:2px;color:#e63946;margin-bottom:18px;text-transform:uppercase;display:flex;align-items:center;gap:8px}
.section-title .cnt{background:#e63946;color:#fff;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:900}
.form-box{background:#111128;border:1px solid #1e1e4a;border-radius:12px;padding:22px}
.fgroup{margin-bottom:18px}
.flabel{display:block;font-size:11px;font-weight:700;color:#666;letter-spacing:1px;text-transform:uppercase;margin-bottom:7px}
.flabel .req{color:#e63946}
textarea{width:100%;background:#0d0d25;border:1px solid #2a2a5a;color:#fff;padding:13px;border-radius:8px;font-size:14px;line-height:1.6;resize:vertical;min-height:110px;font-family:inherit}
textarea:focus{outline:none;border-color:#e63946}
.drop-zone{border:2px dashed #2a2a5a;border-radius:10px;padding:28px 16px;text-align:center;cursor:pointer;background:#0d0d25;position:relative;transition:all .2s}
.drop-zone:hover,.drop-zone.over{border-color:#e63946;background:#1a0a20}
.drop-zone input{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%}
.drop-zone .dz-icon{font-size:36px;margin-bottom:10px}
.drop-zone .dz-txt{font-size:13px;color:#777;margin-bottom:4px}
.drop-zone .dz-hint{font-size:11px;color:#444}
.vid-list{margin-top:14px;display:flex;flex-direction:column;gap:8px}
.vid-item{background:#0d0d25;border:1px solid #2a2a5a;border-radius:8px;padding:9px 13px;display:flex;align-items:center;gap:10px}
.vid-info{flex:1;min-width:0}
.vid-name{font-size:12px;font-weight:600;color:#ccc;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.vid-size{font-size:10px;color:#555;margin-top:2px}
.vid-badge{font-size:11px;font-weight:700;padding:3px 9px;border-radius:4px;flex-shrink:0}
.s-pending{background:#1a1a3a;color:#6666cc}
.s-uploading{background:#1a1200;color:#ffaa00}
.s-done{background:#0a1f0a;color:#4caf50}
.s-error{background:#1f0a0a;color:#e63946}
.rm-btn{background:none;border:none;color:#e63946;font-size:16px;cursor:pointer;padding:2px 6px;flex-shrink:0}
.pb-wrap{background:#1a1a3a;border-radius:3px;height:3px;margin-top:4px;overflow:hidden}
.pb{height:100%;background:linear-gradient(90deg,#e63946,#ff6b7a);border-radius:3px;width:0;transition:width .3s}
.add-btn{width:100%;background:linear-gradient(135deg,#e63946,#c62828);color:#fff;border:none;padding:14px;border-radius:9px;font-size:14px;font-weight:700;cursor:pointer;letter-spacing:1px;text-transform:uppercase;margin-top:6px}
.add-btn:hover{box-shadow:0 6px 20px rgba(230,57,70,.4)}
.add-btn:disabled{opacity:.4;cursor:not-allowed}
/* News Cards */
.news-card{background:#0f0f28;border:1px solid #1a1a3a;border-radius:10px;padding:16px;margin-bottom:14px;transition:border-color .2s}
.news-card:hover{border-color:#2a2a5a}
.nc-header{display:flex;align-items:center;gap:8px;margin-bottom:12px}
.nc-num{background:#e63946;color:#fff;font-size:10px;font-weight:800;padding:2px 7px;border-radius:3px;flex-shrink:0}
.nc-title{font-size:13px;font-weight:700;color:#bbb;flex:1}
.mv-btns{display:flex;flex-direction:column;gap:3px}
.mv-btn{background:#1a1a3a;border:1px solid #2a2a5a;color:#888;width:22px;height:22px;border-radius:4px;cursor:pointer;font-size:10px;display:flex;align-items:center;justify-content:center}
.mv-btn:hover{background:#333366;color:#fff}
.nc-del{background:none;border:1px solid #3a1010;color:#e63946;width:28px;height:28px;border-radius:6px;cursor:pointer;font-size:13px;display:flex;align-items:center;justify-content:center}
.nc-del:hover{background:#e63946;color:#fff}
.nc-text{font-size:12px;color:#666;line-height:1.5;margin-bottom:10px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.nc-vids{display:flex;gap:6px;flex-wrap:wrap}
.nc-vthumb{width:64px;height:44px;border-radius:5px;background:#0d0d25;border:1px solid #2a2a5a;overflow:hidden;position:relative;flex-shrink:0}
.nc-vthumb video{width:100%;height:100%;object-fit:cover}
.nc-vthumb .vplay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.45);font-size:14px}
.nc-more{align-self:center;font-size:11px;color:#555;background:#1a1a3a;padding:3px 8px;border-radius:4px}
.nc-footer{display:flex;gap:14px;font-size:11px;color:#444;margin-top:10px;padding-top:8px;border-top:1px solid #1a1a3a}
.empty{text-align:center;padding:40px 20px;color:#333}
.empty .ei{font-size:44px;margin-bottom:10px}
.empty p{font-size:13px}

/* Toast */
.toasts{position:fixed;bottom:20px;right:20px;z-index:9999;display:flex;flex-direction:column;gap:8px}
.toast{background:#111128;border-left:4px solid #4caf50;padding:12px 18px;border-radius:7px;font-size:13px;color:#fff;box-shadow:0 4px 20px rgba(0,0,0,.5);max-width:300px;animation:tin .3s ease}
.toast.err{border-color:#e63946}
@keyframes tin{from{transform:translateX(110%);opacity:0}to{transform:translateX(0);opacity:1}}

/* Config required warning */
.cfg-warn{background:#1a0a00;border:1px solid #442200;border-radius:8px;padding:12px 16px;font-size:13px;color:#ff9900;margin-bottom:16px;display:none}
.cfg-warn a{color:#e63946;cursor:pointer;font-weight:700}
</style>
</head>
<body>

<div class="topbar">
  <div class="logo">BREAKING</div>
  <h1>Admin Panel</h1>
  <span style="display:flex;align-items:center;font-size:12px;color:#4caf50"><div class="dot"></div>Live</span>
  <a href="index.html">üè† Home</a>
  <a href="broadcast.html" target="_blank">üì° Broadcast ‚Üí</a>
</div>

<!-- TABS -->
<div class="tabs">
  <div class="tab active" onclick="switchTab('news')">üì∞ News Manager</div>
  <div class="tab" onclick="switchTab('config')">‚öôÔ∏è Cloudinary Settings</div>
</div>

<!-- ===== TAB: NEWS MANAGER ===== -->
<div class="panel active" id="tab-news">
  <div class="cfg-warn" id="cfgWarn">
    ‚ö†Ô∏è Cloudinary config set nahi hai! Pehle <a onclick="switchTab('config')">Settings tab</a> mein apni details daalo.
  </div>
  <div class="news-layout">

    <!-- Left: News List -->
    <div>
      <div class="section-title">üìã News Queue <span class="cnt" id="newsCount">0</span></div>
      <div id="newsList">
        <div class="empty"><div class="ei">üì∞</div><p>Abhi koi news nahi.<br>Naya news add karein ‚Üí</p></div>
      </div>
    </div>

    <!-- Right: Add Form -->
    <div>
      <div class="section-title">‚ûï Naya News Add Karein</div>
      <div class="form-box">
        <div class="fgroup">
          <label class="flabel">üìù News Text <span class="req">*</span></label>
          <textarea id="newsText" placeholder="Yahaan news ka text likhein... Hindi ya English dono chalega" rows="4"></textarea>
        </div>
        <div class="fgroup">
          <label class="flabel">üé¨ News Videos <span class="req">*</span></label>
          <div class="drop-zone" id="dropZone">
            <input type="file" id="videoInput" accept="video/*" multiple onchange="handleFiles(this.files)">
            <div class="dz-icon">üé•</div>
            <div class="dz-txt">Click karein ya drag &amp; drop karein</div>
            <div class="dz-hint">MP4, MOV, AVI ‚Ä¢ Multiple videos allowed</div>
          </div>
          <div class="vid-list" id="vidList"></div>
        </div>
        <button class="add-btn" id="addBtn" onclick="submitNews()">üöÄ Upload &amp; Add News</button>
      </div>
    </div>

  </div>
</div>

<!-- ===== TAB: CLOUDINARY SETTINGS ===== -->
<div class="panel" id="tab-config">
  <div class="config-grid">

    <!-- Credentials Card -->
    <div class="config-card">
      <h3>‚òÅÔ∏è Cloudinary Credentials</h3>
      <div class="field">
        <label>Cloud Name</label>
        <input type="text" id="cfgCloudName" placeholder="e.g. my-cloud-123">
        <div class="hint">Cloudinary Dashboard ‚Üí Settings ‚Üí <b>Cloud Name</b></div>
      </div>
      <div class="field">
        <label>Upload Preset <span style="color:#e63946">*</span></label>
        <input type="text" id="cfgUploadPreset" placeholder="e.g. news_videos_unsigned">
        <div class="hint">Settings ‚Üí Upload ‚Üí Upload Presets ‚Üí <b>Unsigned preset naam</b></div>
      </div>
      <div class="field">
        <label>API Key <span style="color:#555">(optional - display only)</span></label>
        <input type="text" id="cfgApiKey" placeholder="e.g. 123456789012345">
        <div class="hint">Sirf reference ke liye ‚Äî upload preset se upload hoga</div>
      </div>
      <button class="save-btn" onclick="saveConfig()">üíæ Save Configuration</button>
      <div class="status-box" id="saveStatus">Config save hone ke baad yahan status dikhega...</div>
    </div>

    <!-- Test & Status Card -->
    <div class="config-card">
      <h3>üß™ Test Connection</h3>
      <div class="field">
        <label>Connection Status</label>
        <div class="status-box" id="testStatus">Test karne ke liye neeche button dabao...</div>
      </div>
      <button class="test-btn" onclick="testConnection()">üîå Test Cloudinary Connection</button>

      <div style="margin-top:20px">
        <div class="field">
          <label>Current Config</label>
          <div class="status-box" id="currentConfig" style="font-family:monospace;font-size:11px">
            Loading...
          </div>
        </div>
      </div>

      <div style="margin-top:12px">
        <button class="test-btn" onclick="clearConfig()" style="border-color:#3a1010;color:#e63946">
          üóëÔ∏è Clear Config
        </button>
      </div>
    </div>

    <!-- How To Guide -->
    <div class="config-card config-full">
      <h3>üìñ Cloudinary Setup Guide</h3>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
        <div class="how-to">
          <h4>STEP 1 ‚Äî Account Banao</h4>
          <ol>
            <li><span>cloudinary.com</span> par free account banao</li>
            <li>Dashboard kholein</li>
            <li><span>Cloud Name</span> copy karein (upar left mein)</li>
          </ol>
        </div>
        <div class="how-to">
          <h4>STEP 2 ‚Äî Upload Preset Banao</h4>
          <ol>
            <li>Settings ‚Üí <span>Upload</span> tab</li>
            <li>"Add upload preset" click karein</li>
            <li>Signing Mode: <span>Unsigned</span> select karein</li>
            <li>Preset naam copy karein</li>
          </ol>
        </div>
        <div class="how-to">
          <h4>STEP 3 ‚Äî Yahan Fill Karein</h4>
          <ol>
            <li>Cloud Name paste karein</li>
            <li>Upload Preset naam paste karein</li>
            <li><span>Save Configuration</span> dabao</li>
            <li>Test Connection verify karein</li>
          </ol>
        </div>
        <div class="how-to">
          <h4>‚ö†Ô∏è Important Notes</h4>
          <ol>
            <li>Preset <span>Unsigned</span> hona chahiye</li>
            <li>Video upload allowed hona chahiye preset mein</li>
            <li>Config browser mein <span>locally</span> save hogi</li>
            <li>Alag device par dobara fill karna hoga</li>
          </ol>
        </div>
      </div>
    </div>

  </div>
</div>

<div class="toasts" id="toasts"></div>

<script>
// ======= STATE =======
let config = {cloudName:'', uploadPreset:'', apiKey:''};
let news = [];
let files = [];

window.onload = () => {
  const sc = localStorage.getItem('bn_cfg');
  if(sc){ config = JSON.parse(sc); fillConfigForm(); }
  const sn = localStorage.getItem('bn_news');
  if(sn){ news = JSON.parse(sn); renderNews(); }
  updateCurrentConfigDisplay();
  checkConfigWarning();

  const dz = document.getElementById('dropZone');
  dz.addEventListener('dragover', e=>{e.preventDefault();dz.classList.add('over')});
  dz.addEventListener('dragleave', ()=>dz.classList.remove('over'));
  dz.addEventListener('drop', e=>{e.preventDefault();dz.classList.remove('over');handleFiles(e.dataTransfer.files)});
};

// ======= TABS =======
function switchTab(t){
  document.querySelectorAll('.tab').forEach((el,i)=>{
    el.classList.toggle('active', (i===0&&t==='news')||(i===1&&t==='config'));
  });
  document.getElementById('tab-news').classList.toggle('active', t==='news');
  document.getElementById('tab-config').classList.toggle('active', t==='config');
}

// ======= CONFIG =======
function fillConfigForm(){
  document.getElementById('cfgCloudName').value = config.cloudName||'';
  document.getElementById('cfgUploadPreset').value = config.uploadPreset||'';
  document.getElementById('cfgApiKey').value = config.apiKey||'';
}

function saveConfig(){
  const cn = document.getElementById('cfgCloudName').value.trim();
  const up = document.getElementById('cfgUploadPreset').value.trim();
  const ak = document.getElementById('cfgApiKey').value.trim();
  if(!cn||!up){ showToast('‚ùå Cloud Name aur Upload Preset zaroori hain!', true); return; }
  config = {cloudName:cn, uploadPreset:up, apiKey:ak};
  localStorage.setItem('bn_cfg', JSON.stringify(config));
  const sb = document.getElementById('saveStatus');
  sb.className = 'status-box success';
  sb.textContent = '‚úÖ Configuration saved! Ab news tab mein videos upload kar sakte ho.';
  updateCurrentConfigDisplay();
  checkConfigWarning();
  showToast('‚úÖ Cloudinary config saved!');
}

function clearConfig(){
  if(!confirm('Config clear karein?')) return;
  config = {cloudName:'',uploadPreset:'',apiKey:''};
  localStorage.removeItem('bn_cfg');
  fillConfigForm();
  updateCurrentConfigDisplay();
  checkConfigWarning();
  document.getElementById('saveStatus').className='status-box';
  document.getElementById('saveStatus').textContent='Config cleared.';
  showToast('üóëÔ∏è Config cleared.');
}

function updateCurrentConfigDisplay(){
  const el = document.getElementById('currentConfig');
  if(config.cloudName){
    el.className='status-box success';
    el.innerHTML = `Cloud Name: <b>${config.cloudName}</b><br>Upload Preset: <b>${config.uploadPreset}</b><br>API Key: ${config.apiKey||'(not set)'}`;
  } else {
    el.className='status-box';
    el.textContent='Config nahi mili. Settings fill karein.';
  }
}

function checkConfigWarning(){
  const w = document.getElementById('cfgWarn');
  w.style.display = (!config.cloudName||!config.uploadPreset) ? 'block' : 'none';
}

async function testConnection(){
  const st = document.getElementById('testStatus');
  if(!config.cloudName||!config.uploadPreset){
    st.className='status-box error'; st.textContent='‚ùå Pehle Cloud Name aur Upload Preset save karein!'; return;
  }
  st.className='status-box'; st.textContent='üîÑ Testing...';
  try {
    const res = await fetch(`https://res.cloudinary.com/${config.cloudName}/image/upload/sample.jpg`);
    if(res.ok || res.status===404){
      st.className='status-box success';
      st.textContent=`‚úÖ Connected! Cloud "${config.cloudName}" reachable hai. Upload try karo.`;
    } else {
      st.className='status-box error'; st.textContent=`‚ö†Ô∏è Cloud name check karein. Status: ${res.status}`;
    }
  } catch(e) {
    st.className='status-box error'; st.textContent='‚ùå Network error. Internet check karein.';
  }
}

// ======= FILES =======
function handleFiles(flist){
  for(const f of flist){
    if(!f.type.startsWith('video/')){ showToast('‚ùå Sirf video files!', true); continue; }
    files.push({f, status:'pending', url:null, id:Math.random()});
  }
  renderFiles();
}

function renderFiles(){
  const el = document.getElementById('vidList');
  if(!files.length){ el.innerHTML=''; return; }
  el.innerHTML = files.map((it,i)=>`
    <div class="vid-item">
      <span>üé¨</span>
      <div class="vid-info">
        <div class="vid-name">${it.f.name}</div>
        <div class="vid-size">${fmtSize(it.f.size)}</div>
        <div class="pb-wrap" id="pb_w_${i}" style="display:none"><div class="pb" id="pb_${i}"></div></div>
      </div>
      <span class="vid-badge s-${it.status}" id="vbadge_${i}">${sLabel(it.status)}</span>
      <button class="rm-btn" onclick="rmFile(${i})">‚úï</button>
    </div>`).join('');
}

function rmFile(i){ files.splice(i,1); renderFiles(); }
function fmtSize(b){ return b<1048576?(b/1024).toFixed(1)+' KB':(b/1048576).toFixed(1)+' MB'; }
function sLabel(s){ return{pending:'‚è≥ Ready',uploading:'‚¨ÜÔ∏è Uploading',done:'‚úÖ Done',error:'‚ùå Error'}[s]||s; }

// ======= UPLOAD =======
async function uploadOne(item, idx){
  item.status='uploading';
  document.getElementById(`vbadge_${idx}`).className='vid-badge s-uploading';
  document.getElementById(`vbadge_${idx}`).textContent='‚¨ÜÔ∏è Uploading';
  document.getElementById(`pb_w_${idx}`).style.display='block';
  const fd = new FormData();
  fd.append('file', item.f);
  fd.append('upload_preset', config.uploadPreset);
  return new Promise((res,rej)=>{
    const x = new XMLHttpRequest();
    x.open('POST',`https://api.cloudinary.com/v1_1/${config.cloudName}/video/upload`);
    x.upload.onprogress = e=>{ if(e.lengthComputable) document.getElementById(`pb_${idx}`).style.width=Math.round(e.loaded/e.total*100)+'%'; };
    x.onload=()=>{
      if(x.status===200){
        const r=JSON.parse(x.responseText);
        item.status='done'; item.url=r.secure_url;
        document.getElementById(`vbadge_${idx}`).className='vid-badge s-done';
        document.getElementById(`vbadge_${idx}`).textContent='‚úÖ Done';
        res(r.secure_url);
      } else {
        item.status='error';
        document.getElementById(`vbadge_${idx}`).className='vid-badge s-error';
        document.getElementById(`vbadge_${idx}`).textContent='‚ùå Error';
        rej(new Error('Upload failed'));
      }
    };
    x.onerror=()=>rej(new Error('Network error'));
    x.send(fd);
  });
}

// ======= SUBMIT =======
async function submitNews(){
  const txt = document.getElementById('newsText').value.trim();
  if(!txt){ showToast('‚ùå News text likhein!',true); return; }
  if(!files.length){ showToast('‚ùå Kam se kam ek video select karein!',true); return; }
  if(!config.cloudName||!config.uploadPreset){ showToast('‚ùå Pehle Settings tab mein Cloudinary config save karein!',true); switchTab('config'); return; }
  const btn=document.getElementById('addBtn');
  btn.disabled=true; btn.textContent='‚¨ÜÔ∏è Uploading videos...';
  try {
    await Promise.all(files.map((it,i)=>uploadOne(it,i)));
    const item={id:Date.now(), text:txt, videos:files.filter(f=>f.url).map(f=>({url:f.url,name:f.f.name})), at:new Date().toISOString()};
    news.push(item); saveNews(); renderNews();
    document.getElementById('newsText').value='';
    files=[]; renderFiles();
    document.getElementById('videoInput').value='';
    showToast(`‚úÖ News added! ${item.videos.length} video(s) uploaded.`);
  } catch(e){ showToast('‚ùå Upload error: '+e.message,true); }
  finally{ btn.disabled=false; btn.textContent='üöÄ Upload & Add News'; }
}

// ======= NEWS RENDER =======
function renderNews(){
  const el=document.getElementById('newsList');
  document.getElementById('newsCount').textContent=news.length;
  if(!news.length){ el.innerHTML='<div class="empty"><div class="ei">üì∞</div><p>Koi news nahi.<br>Naya add karein ‚Üí</p></div>'; return; }
  el.innerHTML=news.map((it,i)=>`
    <div class="news-card">
      <div class="nc-header">
        <span class="nc-num">#${i+1}</span>
        <span class="nc-title">News ${i+1}</span>
        <div class="mv-btns">
          ${i>0?`<button class="mv-btn" onclick="mvNews(${i},-1)">‚ñ≤</button>`:'<div style="width:22px"></div>'}
          ${i<news.length-1?`<button class="mv-btn" onclick="mvNews(${i},1)">‚ñº</button>`:'<div style="width:22px"></div>'}
        </div>
        <button class="nc-del" onclick="delNews(${it.id})">‚úï</button>
      </div>
      <div class="nc-text">${it.text}</div>
      <div class="nc-vids">
        ${it.videos.slice(0,4).map(v=>`<div class="nc-vthumb"><video src="${v.url}" muted preload="metadata"></video><div class="vplay">‚ñ∂</div></div>`).join('')}
        ${it.videos.length>4?`<span class="nc-more">+${it.videos.length-4}</span>`:''}
      </div>
      <div class="nc-footer"><span>üé¨ ${it.videos.length} video(s)</span><span>üïê ${new Date(it.at).toLocaleString('hi-IN')}</span></div>
    </div>`).join('');
}

function delNews(id){ if(!confirm('Delete?'))return; news=news.filter(n=>n.id!==id); saveNews(); renderNews(); showToast('üóëÔ∏è Deleted.'); }
function mvNews(i,d){ const j=i+d; if(j<0||j>=news.length)return; [news[i],news[j]]=[news[j],news[i]]; saveNews(); renderNews(); }
function saveNews(){ localStorage.setItem('bn_news',JSON.stringify(news)); }

// ======= TOAST =======
function showToast(msg,err=false){
  const c=document.getElementById('toasts');
  const t=document.createElement('div');
  t.className='toast'+(err?' err':''); t.textContent=msg;
  c.appendChild(t); setTimeout(()=>t.remove(),4000);
}
</script>
</body>
</html>
